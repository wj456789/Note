# Docker

## 概念

### 虚拟机(VM)和容器

- 虚拟机允许多应用能够稳定、安全地同时运行在一个服务器中的技术，但是最大的缺点就是依赖其专用的操作系统(OS)，OS会占用额外的CPU、RAM和存储，而且安装在OS上的应用，进行迁移难度和成本都很高。

- 容器模型其实跟虚拟机模型相似，其主要的区别在于，运行在相同宿主机上的容器是共享一个操作系统的。

### Docker

Docker是容器模型中的一种具体的实现产品，是一个运行在Windows或Linux上的软件。

#### 镜像

镜像是一堆静态文件。比如虚拟机本质是许多文件，可以把这些文件看成虚拟机镜像，整体移动文件，即是移动虚拟机。

- 虚拟机镜像安装的是操作系统，操作系统上可以安装各种应用。

- Docker镜像是应用和支撑应用所必须的环境，比如web镜像是一个web应用和支撑web应用的环境如tomcat、jdk、mysql等。

#### 容器

可以把容器看装镜像的盒子，容器彼此之间相互隔离、互不可见，可以运行里边的镜像里的应用。镜像的静态文件在容器中动态运行。

#### 仓库

镜像仓库服务器存放着多个仓库。每个仓库存放某一类镜像，通过不同的标签( tag)来进行区分。

根据所存储的镜像公开分享与否，Docker 仓库可以分为公开仓库(Public) 和私有仓库(Private) 两种形式。

#### Docker引擎

- Docker引擎是用于运行和编排容器的基础设施工具(之后安装的服务，其他产品运行在服务上)。Docker引擎是是容器最核心的东西，其他产品基于Docker引擎的核心功能进行集成。

- 2017 年第一季度以前，Docker 版本号遵循**大版本号.小版本号的格式**。采用新格式前的最后一个版本是Docker 1.13。从2017年第一季度开始，Docker 版本号遵循YY.MM-xx格式，例如，2018 年6月第一次发布的社区版本为18.06.0-CE。

- Linux安装

  ```sh
  #安装Docker CE
  yum -y install docker-ce docker-ce-cli containerd.io
  #启动Docker
  systemctl start docker
  systemctl status docker
  #测试安装好没的
  docker version
  ```

  配置

  ```sh
  #-D：开启Debug模式
  #-H：设置监听端口
  $ dockerd -D -H tcp://127.0.0.1:2376
  
  #修改Docker配置文件/etc/docker/daemon.json，随着dockerd启动而生效：
  {
  "debug": true,
  "hosts": {"tcp://127.0.0.1:2376"}
  }
  ```

#### 使用Docker镜像

镜像：是静态的，里边有应用，是没有运行起来的应用。好比Java的类。

容器：是动态的，是镜像跑起来，运行起来后的概念，镜像在怎么跑起来，靠Docker引擎。好比类实例化后的对象。

宿主机：安装Docker引擎的计算机主机

虚拟机：在虚拟机引擎里安装的操作系统。

物理机：在物理计算机上安装的操作系统。



通过Docker引擎下载镜像，启动镜像(基于镜像生成一个容器实例)



























