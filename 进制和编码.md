# 进制和编码

## Unicode编码

### 字符处理方式

先在字符和数字之间进行映射(编码)，然后把数字转换为二进制，比如将字符“A”映射为10进制整数65，然后再将65直接映射为二进制数0100 0001。

第一次编码准确的说其实就是为每个字符编了一个号，这个编号可方便人们使用，编号通常是10进制或16进制数，这样在以后指定某个字符时，可以直接使用数字来指定这个字符，很明显，直接使用二进制更不方便，比如，对于ASCII字符集，可以方便的使用65表示字符“A”，显然，使用二进制数0100 0001更不方便。

### Unicode编码模型

1. 第一层：抽象字符表ACR(Abstract Character Reertoire)

   ACR用于确定可以编码的字符的范围(即，确定支持哪些字符)。

2. 第二层：编号(编码)字符集CSS(Coded Character Set)

   为每个字符编一个唯一的编号，从而形成一个庞大的“字符编号对”的集合，这个集合就是编号字符集CSS，Unicode字符的编号是使用16进制数表示的。

3. 第三层：字符编码方式CEF(Character Encoding Form，或翻译为字符编码表)

   把字符编号编码为逻辑上的码元序列(即，逻辑字符编码)，注意：码元序列已经是一个二进制串了，常见编码方式有UTF-8，UTF-16，UTF-32，此步骤的三种编码方式统称为Unicode编码。

4. 第四层：字符编码方案CES(Character Encoding Scheme)

   将逻辑上的码元序列映射为物理上的字节序列(即，物理字符编码)，字节序列仍是一个二进制串，此步骤的主要目的是确定码元序列的字节序列，字节序列确定之后就可以直接由计算机处理、存储了，由于UTF-8编码不存在字节序问题，所以使用UTF-8编码的字符不需要经过此层。

5. 第五层：传输编码语法TES(Transfer encoding Syntax)

   将字节序列进一步编码处理，以适合于在网络中传输。

比如：Unicode编码，字符“A”映射为16进制整数41(字符串表示形式"\u0041")，然后再将41直接映射为二进制数0100 0001。

```java
/**
 * 获取字符串的unicode编码序列
 * @param s string
 * @return unicode编码后的字符串
 */
public static String stringToUnicode(String s) {
    StringBuffer sb = new StringBuffer();
    for (int i = 0; i < s.length(); i++) {
        if (s.charAt(i) < 256) {//ASC11表中的字符码值不够4位,补00
            sb.append("\\u00");
        }else {
            sb.append("\\u");
        }
        sb.append(Integer.toHexString(s.charAt(i)));
    }
    return sb.toString();
}

/**
 * 根据unicode编码序列字符串获取字符串
 * @param unicodeValues unicode码值序列,e.g. "\\u0063\\u0064"
 * @return 解码后的字符串序列
 */
public static String unicodeToString(String unicode) {
    StringBuffer sb = new StringBuffer();
    int pos = 0;
    int i;
    while((i = unicode.indexOf("\\u", pos)) != -1) {
        sb.append(unicode.substring(pos, i));
        if (i + 5 < unicode.length()) {
            pos = i + 6;
            sb.append((char)Integer.parseInt(unicode.substring(i + 2, i + 6), 16));
        }
    }
    return sb.toString();
}

/**
 * 根据unicode编码序列获取字符串,直接输出即可
 * @param unicodeValues unicode码值序列,e.g. "\u0063\u0064"
 * @return 解码后的字符串序列
 */
public static String toCharSequence(String unicodeValues) {
    return unicodeValues;
}



System.out.println(stringToUnicode("Ab汉字"));
System.out.println(unicodeToString("\\u0041\\u0062\\u6c49\\u5b57"));
System.out.println(toCharSequence("\u0041\u0062\u6c49\u5b57"));
输出：
\u0041\u0062\u6c49\u5b57
Ab汉字
Ab汉字    
```























