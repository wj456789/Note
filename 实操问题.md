# 实操问题

## CPU使用率飙升

### 原理

CPU 使用率高的关键因素是计算密集型操作

日常程序中常见的耗CPU的操作：

1、频繁GC，访问量高时，有可能造成频繁的GC、甚至FGC。当调用量大时，内存分配过快，就会造成GC线程不停的执行，导致CPU飙高

2、序列化与反序列化，后文中举了一个真实的案例，程序执行xml解析的时，调用量增大的情况下，导致了CPU被打满

3、加密解密

4、正则表达式校验，曾经线上发生一次血案，正则校验将CPU打满。大概原因是：Java 正则表达式使用的引擎实现是 NFA 自动机，这种引擎在进行字符匹配会发生回溯（backtracking）

5、线程上下文切换、当启动了很多线程，而这些线程都处于不断的阻塞状态（锁等待、IO等待等）和执行状态的变化过程中。当锁竞争激烈时，很容易出现这种情况

6、某些线程在做无阻塞的运算，简单的例子while(true)中不停的做运算，没有任何阻塞。写程序时，如果需要做很久的计算，可以适当将程序sleep下

7、Excel 导出事件

[CPU使用率飙升](https://cloud.tencent.com/developer/article/1650717)

### 定位问题

```sh
1. top命令查看系统使用信息，找出消耗最大的进程，如进程id为24152
2. 查找该进程内最耗费CPU的线程,可以使用如下命令：ps -Lfp pid, ps -mp pid -o THREAD, top -Hp pid
如：
$ top -Hp 24152		# 查看java进程中各线程CPU等的使用情况
如最耗费性能的线程pid为24937
3. 获取线程id 24937的十六进制值
$ printf "%x\n" 24937
6169
4. 查看堆栈信息
4.1 使用jstack来输出线程id 24937的堆栈信息，根据线程id的十六进制值grep
$ jstack 24152 | grep 6169
"elasticsearch[Grenade][bulk][T#1]" #49 daemon prio=5 os_prio=0 tid=0x00007f78440b2000 nid=0x6169 runnable [0x00007f7840fa1000]

4.2 查看详细堆栈信息
$ jstack 24152	# 查看进程中所有线程调用栈

4.3 可以导出进程快照
$ jstack -l 24152 > ./24152.stack
# 查看线程操作(-C 表示查找出的文档展示上下10行)
$ cat 24152.stack | grep '6169' -C 10
```

**jstack堆栈信息解析：**

线程状态
Blocking: 现在在等待锁(Lock或synchronized)
Waiting: 等待其他线程执行某些操作
Runnable: 就绪或运行状态
Timed_Waiting: 限时等待


打印出该线程信息，显示该线程是runnable正常运行的就绪状态，经查看详细堆栈信息，应该是es内部创建分片索引的进程，因此占用比较多性能，在对自己环境进程正式排查的时候，可以多进行几次打印，对比多次之间的线程运行情况，正常情况下由于程序运行速度是非常快的，如果发现多次打印对于线程都一直处于同一状态如Runnable，而且堆栈信息也卡在相同的几处地方，就可以考虑看一下对应代码是不是存在死循环或者方法调用缓慢的问题了。

注意JDK运行工具和运行中的java进程必须同一个版本，且必须使用JDK工具所属用户运行命令



Locked ownable synchronizers 每个线程线的最后部分输出的当前线程持有的锁对象，类型和地址。

**备注：**

可以使用perf，Linux自带的强大性能分析工具，可以对对监控事件进行采样(案例：http://brendangregg.com/perf.html)
然后使用 FlameGraph ，生成svg火焰图，直观展示热点代码路径
下载链接：https://github.com/brendangregg/FlameGraph



[jstack](https://www.cnblogs.com/kongzhongqijing/articles/3630264.html) 

[JVM调试工具](https://www.cnblogs.com/JonaLin/p/13859494.html)

[定位消耗CPU最多的线程](https://blog.csdn.net/yue_2018/article/details/106598436)



[内存溢出排查过程，用了MAT和jvisualvm](https://aobing.blog.csdn.net/article/details/105376377?spm=1001.2014.3001.5502)

[排查CPU打到100%](https://aobing.blog.csdn.net/article/details/105278061?spm=1001.2014.3001.5502)

[使用jvisualVM监控远程linux服务器上运行的jar程序](https://blog.csdn.net/dap769815768/article/details/86759911)



[Locked ownable synchronizers（转）](https://www.cnblogs.com/softidea/p/4440290.html)





### 堆栈信息

44580.stack

```java
"https-jsse-nio-8760-exec-25" #98 daemon prio=5 os_prio=0 tid=0x00007fba68005800 nid=0x142 waiting for monitor entry [0x00007fba4224d000]
   java.lang.Thread.State: BLOCKED (on object monitor)
	at com.huawei.aspect.UserLogInfoAspect.aroundMethod(UserLogInfoAspect.java:80)
	- waiting to lock <0x00000006c71d9cd0> (a com.huawei.aspect.UserLogInfoAspect)
	at sun.reflect.GeneratedMethodAccessor238.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at com.huawei.dataasset.controller.ProblemManagementController$$EnhancerBySpringCGLIB$$268b375.getProblemList(<generated>)
	at sun.reflect.GeneratedMethodAccessor409.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1067)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.dataasset.filter.InterfaceAuthFilter.doFilter(InterfaceAuthFilter.java:69)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.dataasset.filter.EncodingFilter.doFilter(EncodingFilter.java:56)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.security.validator.filter.ParamCheckFilter.doFilter(ParamCheckFilter.java:177)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.dataasset.filter.UserAccessAuthFilter.doFilter(UserAccessAuthFilter.java:64)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.springframework.security.web.csrf.CsrfAntiFilter.doFilter(CsrfAntiFilter.java:131)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.dataasset.filter.UapUserInfoFilter.doFilter(UapUserInfoFilter.java:74)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.dataasset.filter.UserSessionFilter.doFilter(UserSessionFilter.java:85)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.filter.LanguageFilter.doFilter(LanguageFilter.java:42)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.us.common.filter.UsHttpsOnlyFilter.doFilter(UsHttpsOnlyFilter.java:77)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.us.common.filter.UsHttpRequestIpFilter.doFilter(UsHttpRequestIpFilter.java:83)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.springframework.security.web.dos.DosPrecautionFilter.doFilter(DosPrecautionFilter.java:66)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.us.wsf.filter.UsCookieFilter.doFilter(UsCookieFilter.java:91)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.us.wsf.filter.UsHeaderWriterFilter.doFilter(UsHeaderWriterFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.us.wsf.filter.UsSecureHttpFilter.doFilter(UsSecureHttpFilter.java:57)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.us.common.filter.UsRequestNormalizeFilter.doFilter(UsRequestNormalizeFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.us.common.filter.UsHttpHeaderFilter.doFilter(UsHttpHeaderFilter.java:95)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.sso.client.filter.SingleSignOnFilterChainProxy.doFilter(SingleSignOnFilterChainProxy.java:140)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.boot.web.servlet.support.ErrorPageFilter.doFilter(ErrorPageFilter.java:126)
	at org.springframework.boot.web.servlet.support.ErrorPageFilter.access$000(ErrorPageFilter.java:64)
	at org.springframework.boot.web.servlet.support.ErrorPageFilter$1.doFilterInternal(ErrorPageFilter.java:101)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.boot.web.servlet.support.ErrorPageFilter.doFilter(ErrorPageFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.logging.log4j.web.Log4jServletFilter.doFilter(Log4jServletFilter.java:71)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at com.huawei.openas.monitor.valve.RequestCounterValve.invoke(RequestCounterValve.java:100)
	at org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:687)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:346)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:387)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:919)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1723)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	- locked <0x0000000793ff29e0> (a org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

   Locked ownable synchronizers:
	- <0x00000006c86b21f8> (a java.util.concurrent.ThreadPoolExecutor$Worker)

....................................................

"https-jsse-nio-8760-exec-21" #94 daemon prio=5 os_prio=0 tid=0x00007fba68015000 nid=0xf7d4 runnable [0x00007fba42d50000]
   java.lang.Thread.State: RUNNABLE
	at java.lang.Character.toLowerCase(Character.java:6374)
	at java.lang.Character.toLowerCase(Character.java:6345)
	at java.lang.String.toLowerCase(String.java:2581)
	at com.huawei.dataasset.service.searchoptimization.impl.BusiModelServiceImpl.containsWords(BusiModelServiceImpl.java:385)
	at com.huawei.dataasset.service.searchoptimization.impl.BusiModelServiceImpl.lambda$handleField$0(BusiModelServiceImpl.java:366)
	at com.huawei.dataasset.service.searchoptimization.impl.BusiModelServiceImpl$$Lambda$1124/1923610477.accept(Unknown Source)
	at java.util.ArrayList.forEach(ArrayList.java:1257)
	at com.huawei.dataasset.service.searchoptimization.impl.BusiModelServiceImpl.handleField(BusiModelServiceImpl.java:361)
	at com.huawei.dataasset.service.searchoptimization.impl.BusiModelServiceImpl.buildResult(BusiModelServiceImpl.java:333)
	at com.huawei.dataasset.service.searchoptimization.impl.BusiModelServiceImpl.setReportdataAttributesInfo(BusiModelServiceImpl.java:310)
	at com.huawei.dataasset.service.searchoptimization.impl.BusiModelServiceImpl.setFourModelAttributesInfo(BusiModelServiceImpl.java:160)
	at com.huawei.dataasset.service.searchoptimization.impl.BusiModelServiceImpl.getModels(BusiModelServiceImpl.java:111)
	at com.huawei.dataasset.service.searchoptimization.impl.AsearchOptimizationService.search(AsearchOptimizationService.java:142)
	at com.huawei.dataasset.service.impl.ElasticsearchImpl.searchBusiAssert(ElasticsearchImpl.java:98)
	at com.huawei.dataasset.controller.EsSearchController.handleByOwsType(EsSearchController.java:976)
	at com.huawei.dataasset.controller.EsSearchController.damsSearch(EsSearchController.java:847)
	at com.huawei.dataasset.controller.EsSearchController$$FastClassBySpringCGLIB$$15c03882.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.AspectJAfterThrowingAdvice.invoke(AspectJAfterThrowingAdvice.java:64)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.adapter.AfterReturningAdviceInterceptor.invoke(AfterReturningAdviceInterceptor.java:57)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor.invoke(MethodBeforeAdviceInterceptor.java:58)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at com.huawei.aspect.UserLogInfoAspect.aroundMethod(UserLogInfoAspect.java:88)
	- locked <0x00000006c71d9cd0> (a com.huawei.aspect.UserLogInfoAspect)
	at sun.reflect.GeneratedMethodAccessor238.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at com.huawei.dataasset.controller.EsSearchController$$EnhancerBySpringCGLIB$$64695ff1.damsSearch(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1067)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.dataasset.filter.UserSessionFilter.doFilter(UserSessionFilter.java:125)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.dataasset.filter.InterfaceAuthFilter.doFilter(InterfaceAuthFilter.java:69)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.dataasset.filter.EncodingFilter.doFilter(EncodingFilter.java:56)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.security.validator.filter.ParamCheckFilter.doFilter(ParamCheckFilter.java:177)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.dataasset.filter.UserAccessAuthFilter.doFilter(UserAccessAuthFilter.java:64)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.springframework.security.web.csrf.CsrfAntiFilter.doFilter(CsrfAntiFilter.java:131)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.dataasset.filter.UapUserInfoFilter.doFilter(UapUserInfoFilter.java:74)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.dataasset.filter.UserSessionFilter.doFilter(UserSessionFilter.java:125)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.filter.LanguageFilter.doFilter(LanguageFilter.java:42)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.us.common.filter.UsHttpsOnlyFilter.doFilter(UsHttpsOnlyFilter.java:77)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.us.common.filter.UsHttpRequestIpFilter.doFilter(UsHttpRequestIpFilter.java:83)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.springframework.security.web.dos.DosPrecautionFilter.doFilter(DosPrecautionFilter.java:66)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.us.wsf.filter.UsCookieFilter.doFilter(UsCookieFilter.java:91)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.us.wsf.filter.UsHeaderWriterFilter.doFilter(UsHeaderWriterFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.us.wsf.filter.UsSecureHttpFilter.doFilter(UsSecureHttpFilter.java:57)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.us.common.filter.UsRequestNormalizeFilter.doFilter(UsRequestNormalizeFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.us.common.filter.UsHttpHeaderFilter.doFilter(UsHttpHeaderFilter.java:95)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at com.huawei.sso.client.filter.SingleSignOnFilterChainProxy.doFilter(SingleSignOnFilterChainProxy.java:140)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.boot.web.servlet.support.ErrorPageFilter.doFilter(ErrorPageFilter.java:126)
	at org.springframework.boot.web.servlet.support.ErrorPageFilter.access$000(ErrorPageFilter.java:64)
	at org.springframework.boot.web.servlet.support.ErrorPageFilter$1.doFilterInternal(ErrorPageFilter.java:101)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.boot.web.servlet.support.ErrorPageFilter.doFilter(ErrorPageFilter.java:119)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.logging.log4j.web.Log4jServletFilter.doFilter(Log4jServletFilter.java:71)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at com.huawei.openas.monitor.valve.RequestCounterValve.invoke(RequestCounterValve.java:100)
	at org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:687)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:346)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:387)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:919)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1723)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	- locked <0x000000078f055680> (a org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

   Locked ownable synchronizers:
	- <0x00000006c86e3638> (a java.util.concurrent.ThreadPoolExecutor$Worker)
	
	...............................................
        
	"Catalina-utility-2" #63 prio=1 os_prio=0 tid=0x00007fba3800d000 nid=0xb01c waiting on condition [0x00007fbaf2a1a000]
   java.lang.Thread.State: TIMED_WAITING (parking)
	at sun.misc.Unsafe.park(Native Method)
	- parking to wait for  <0x00000006c3585448> (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject)
	at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078)
	at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:1093)
	at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:809)
	at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1074)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

   Locked ownable synchronizers:
	- None

	..............................................
	
"I/O dispatcher 16" #58 prio=5 os_prio=0 tid=0x00007fba700d7800 nid=0xb017 runnable [0x00007fbae04c6000]
   java.lang.Thread.State: RUNNABLE
	at sun.nio.ch.EPollArrayWrapper.epollWait(Native Method)
	at sun.nio.ch.EPollArrayWrapper.poll(EPollArrayWrapper.java:269)
	at sun.nio.ch.EPollSelectorImpl.doSelect(EPollSelectorImpl.java:93)
	at sun.nio.ch.SelectorImpl.lockAndDoSelect(SelectorImpl.java:86)
	- locked <0x00000006c648dde0> (a sun.nio.ch.Util$3)
	- locked <0x00000006c648ddd0> (a java.util.Collections$UnmodifiableSet)
	- locked <0x00000006c648dc98> (a sun.nio.ch.EPollSelectorImpl)
	at sun.nio.ch.SelectorImpl.select(SelectorImpl.java:97)
	at org.apache.http.impl.nio.reactor.AbstractIOReactor.execute(AbstractIOReactor.java:255)
	at org.apache.http.impl.nio.reactor.BaseIOReactor.execute(BaseIOReactor.java:104)
	at org.apache.http.impl.nio.reactor.AbstractMultiworkerIOReactor$Worker.run(AbstractMultiworkerIOReactor.java:591)
	at java.lang.Thread.run(Thread.java:748)

   Locked ownable synchronizers:
	- None
	
	"MyScheduler_Worker-5" #30 prio=5 os_prio=0 tid=0x00007fbb6e67e800 nid=0xafb3 in Object.wait() [0x00007fbae2bf8000]
   java.lang.Thread.State: TIMED_WAITING (on object monitor)
	at java.lang.Object.wait(Native Method)
	at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:568)
	- locked <0x00000006c6454960> (a java.lang.Object)

   Locked ownable synchronizers:
	- None
	
	.....................................

	"Log4j2-TF-6-Scheduled-2" #18 daemon prio=5 os_prio=0 tid=0x00007fbb6dea0800 nid=0xaee5 waiting on condition [0x00007fbaf17b7000]
   java.lang.Thread.State: TIMED_WAITING (parking)
	at sun.misc.Unsafe.park(Native Method)
	- parking to wait for  <0x00000006c4394570> (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject)
	at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078)
	at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:1093)
	at java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:809)
	at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1074)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

   Locked ownable synchronizers:
	- None

"GC Daemon" #15 daemon prio=2 os_prio=0 tid=0x00007fbb6cc1a000 nid=0xae59 in Object.wait() [0x00007fbb04b8a000]
   java.lang.Thread.State: TIMED_WAITING (on object monitor)
	at java.lang.Object.wait(Native Method)
	- waiting on <0x00000006c35f4a80> (a sun.misc.GC$LatencyLock)
	at sun.misc.GC$Daemon.run(GC.java:117)
	- locked <0x00000006c35f4a80> (a sun.misc.GC$LatencyLock)

   Locked ownable synchronizers:
	- None

"Service Thread" #11 daemon prio=9 os_prio=0 tid=0x00007fbb6c16c000 nid=0xae46 runnable [0x0000000000000000]
   java.lang.Thread.State: RUNNABLE

   Locked ownable synchronizers:
	- None

"C1 CompilerThread3" #10 daemon prio=9 os_prio=0 tid=0x00007fbb6c12d800 nid=0xae45 waiting on condition [0x0000000000000000]
   java.lang.Thread.State: RUNNABLE

   Locked ownable synchronizers:
	- None

"C2 CompilerThread2" #9 daemon prio=9 os_prio=0 tid=0x00007fbb6c12b000 nid=0xae44 waiting on condition [0x0000000000000000]
   java.lang.Thread.State: RUNNABLE

   Locked ownable synchronizers:
	- None

"C2 CompilerThread1" #8 daemon prio=9 os_prio=0 tid=0x00007fbb6c129800 nid=0xae43 waiting on condition [0x0000000000000000]
   java.lang.Thread.State: RUNNABLE

   Locked ownable synchronizers:
	- None

"C2 CompilerThread0" #7 daemon prio=9 os_prio=0 tid=0x00007fbb6c126800 nid=0xae42 waiting on condition [0x0000000000000000]
   java.lang.Thread.State: RUNNABLE

   Locked ownable synchronizers:
	- None

"JDWP Event Helper Thread" #6 daemon prio=10 os_prio=0 tid=0x00007fbb6c124000 nid=0xae41 runnable [0x0000000000000000]
   java.lang.Thread.State: RUNNABLE

   Locked ownable synchronizers:
	- None

"JDWP Transport Listener: dt_socket" #5 daemon prio=10 os_prio=0 tid=0x00007fbb6c120800 nid=0xae40 runnable [0x0000000000000000]
   java.lang.Thread.State: RUNNABLE

   Locked ownable synchronizers:
	- None

"Signal Dispatcher" #4 daemon prio=9 os_prio=0 tid=0x00007fbb6c113800 nid=0xae3f runnable [0x0000000000000000]
   java.lang.Thread.State: RUNNABLE

   Locked ownable synchronizers:
	- None

"Finalizer" #3 daemon prio=8 os_prio=0 tid=0x00007fbb6c0e1800 nid=0xae3e in Object.wait() [0x00007fbb54fb3000]
   java.lang.Thread.State: WAITING (on object monitor)
	at java.lang.Object.wait(Native Method)
	at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:144)
	- locked <0x00000006c35f5b60> (a java.lang.ref.ReferenceQueue$Lock)
	at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:165)
	at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:216)

   Locked ownable synchronizers:
	- None

"Reference Handler" #2 daemon prio=10 os_prio=0 tid=0x00007fbb6c0df000 nid=0xae3d in Object.wait() [0x00007fbb550b4000]
   java.lang.Thread.State: WAITING (on object monitor)
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at java.lang.ref.Reference.tryHandlePending(Reference.java:191)
	- locked <0x00000006c35f5b90> (a java.lang.ref.Reference$Lock)
	at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:153)

   Locked ownable synchronizers:
	- None

"main" #1 prio=5 os_prio=0 tid=0x00007fbb6c051000 nid=0xae29 runnable [0x00007fbb73bdf000]
   java.lang.Thread.State: RUNNABLE
	at java.net.PlainSocketImpl.socketAccept(Native Method)
	at java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:409)
	at java.net.ServerSocket.implAccept(ServerSocket.java:545)
	at java.net.ServerSocket.accept(ServerSocket.java:513)
	at org.apache.catalina.core.StandardServer.await(StandardServer.java:609)
	at org.apache.catalina.startup.Catalina.await(Catalina.java:864)
	at org.apache.catalina.startup.Catalina.start(Catalina.java:810)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:367)
	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:498)

   Locked ownable synchronizers:
	- None

"VM Thread" os_prio=0 tid=0x00007fbb6c0d5800 nid=0xae3c runnable 

"GC task thread#0 (ParallelGC)" os_prio=0 tid=0x00007fbb6c063800 nid=0xae34 runnable 

"GC task thread#1 (ParallelGC)" os_prio=0 tid=0x00007fbb6c065800 nid=0xae35 runnable 

"GC task thread#2 (ParallelGC)" os_prio=0 tid=0x00007fbb6c067800 nid=0xae36 runnable 

"GC task thread#3 (ParallelGC)" os_prio=0 tid=0x00007fbb6c069000 nid=0xae37 runnable 

"GC task thread#4 (ParallelGC)" os_prio=0 tid=0x00007fbb6c06b000 nid=0xae38 runnable 

"GC task thread#5 (ParallelGC)" os_prio=0 tid=0x00007fbb6c06d000 nid=0xae39 runnable 

"GC task thread#6 (ParallelGC)" os_prio=0 tid=0x00007fbb6c06e800 nid=0xae3a runnable 

"GC task thread#7 (ParallelGC)" os_prio=0 tid=0x00007fbb6c070800 nid=0xae3b runnable 

"VM Periodic Task Thread" os_prio=0 tid=0x00007fbb6c16e800 nid=0xae47 waiting on condition 

JNI global references: 16395
```

### 定位处理

```java
上述为进程堆栈部分快照，定位线程0xf7d4占用cpu最大，查看堆栈信息：
com.huawei.dataasset.service.searchoptimization.impl.BusiModelServiceImpl.containsWords(BusiModelServiceImpl.java:385)
	at com.huawei.dataasset.service.searchoptimization.impl.BusiModelServiceImpl.lambda$handleField$0(BusiModelServiceImpl.java:366)
	at com.huawei.dataasset.service.searchoptimization.impl.BusiModelServiceImpl$$Lambda$1124/1923610477.accept(Unknown Source)
	at java.util.ArrayList.forEach(ArrayList.java:1257)
	at 

定位BusiModelServiceImpl中handleField和containsWords方法，远程debug发现当infos数据量超过万条之后，多重循环，数据匹配造成大量cpu占用，处理时间超过8分钟
解决：
添加条件判断减少循环次数，使用ForkJoinPool多线程加快处理速度

public class BusiModelServiceImpl{
	......
	private void handleField(String keyword, String searchRange, String[] interfaceEsFields, Map<String, Object> result,
        ......
        infos.forEach(info -> {
            String[] vals = info.split(",");
            for (int i = 0; i < vals.length; i++) {
                String val = vals[i];
                // i < finalInterfaceEsFields.length代表字段拼接值应与配置文件中配置的字段个数一致
                if (i < finalInterfaceEsFields.length && containsWords(infoStr, keyword, true)
                    && containsWords(val, keyword, false)) {
                    String fieldKey = vals[0] + "." + finalInterfaceEsFields[i];
                    Map<String, Object> field = new HashMap<>();
                    field.put("key", fieldKey);
                    field.put("value", val);
                    fields.add(field);
                }
            }
        });
        ......
	}
	private boolean containsWords(String inputString, String keyword, boolean isAllContains) {
		inputString = inputString.toLowerCase(Locale.ENGLISH);
		boolean found = isAllContains;
		String[] keywords = keyword.split(" ");
		for (String word : keywords) {
			// 是否全包含
			if (isAllContains) {
				// 是全包含，有一个不包含的则返回false
				if (!inputString.contains(word.toLowerCase(Locale.ENGLISH))) {
					found = false;
					break;
				}
			} else {
				// 不是全包含，有一个包含的则返回true
				if (inputString.contains(word.toLowerCase(Locale.ENGLISH))) {
					found = true;
					break;
				}
			}
		}
		return found;
	}
	......
}
```













